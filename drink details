
import 'package:drink/components/qty_widget.dart';
import 'package:drink/components/togglewidget.dart';
import 'package:drink/model.dart';
import 'package:flutter/material.dart';
class DrinkDetails extends StatefulWidget {
  const DrinkDetails({super.key});

  @override
  State<DrinkDetails> createState() => _DrinkDetailsState();
}

class _DrinkDetailsState extends State<DrinkDetails> {
  final PageController _controller = PageController(viewportFraction: 0.50) ;
  double _currentPage =0;
  @override
  void initState() {
    _controller.addListener((){
      setState(() {
        _currentPage = _controller.page ??1 ;
      });

    });
    super.initState();
  }
  // logic
  int seclectedIndex =0;

  // access model easity
  final drinks =DrinkModel.drinks;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.pink[100],
      body: Stack(
        children: [
          Positioned(top:80, left:20,right: 20,child: Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              Column(
                crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(drinks[_currentPage.round()].name,style: TextStyle(fontWeight: FontWeight.bold,fontSize: 17),),
                Text(drinks[_currentPage.round()].title),

              ],
            ),
              Text("â‚¬ ${drinks[_currentPage.round()].price}",style: TextStyle(fontWeight: FontWeight.bold,fontSize: 17)),
            ],

          ),

          ),
          PageView.builder(controller: _controller,
            itemCount: drinks.length,
              scrollDirection: Axis.horizontal,
              itemBuilder:(context,index){
            final scale=1-(_currentPage-index).abs() * 0.1;
            final translatY =(_currentPage - index).abs()*400;
                return Transform.scale(
                  scale:scale.clamp(0.5, 0.7) ,
                  child: Column(
                    children: [
                      Stack(
                        children: [
                          Image.asset( drinks[index].image,height: 900,fit: BoxFit.contain,),
                  Positioned(

                    child: Container(
                    width: 70,
                  height: 20,
                  decoration:BoxDecoration( borderRadius: BorderRadius.circular(100),
                  boxShadow: [
                  BoxShadow (
                  color: Colors.black87,
                  blurRadius: 70,
                  spreadRadius:10),
                  ],

                  ),
                  ),
                    bottom: 250,
                    left: 0,
                    right: 0,
                  ),
                  ],
                  ),

                    ],
                  ),
                );

              },
          ),
          // multi selection
          Positioned(
            bottom:100, left:0,right: 0,
            child: Padding(
              padding: const EdgeInsets.symmetric(horizontal: 20.0),
              child: Column(
                children: [
                  Row(mainAxisAlignment: MainAxisAlignment.spaceBetween,
                    children: List.generate(4, (index){
                      return GestureDetector(
                        onTap: (){
                          setState(() {
                            seclectedIndex=index;
                          });
                        },
                        child: Container(
                          padding: EdgeInsets.all(8),
                          decoration: BoxDecoration(
                          shape: BoxShape.circle,
                          border: Border.all(color: Colors.black87),
                          color:seclectedIndex ==index?Colors.pink :Colors.white,


                        ),

                          child: Icon(
                            Icons.align_horizontal_center_sharp,
                            color:seclectedIndex ==index?Colors.white: Colors.black54,),
                        ),
                      );


                    },


                  )

                  ),
                  SizedBox(height:30,),
                  QtyWidget(),
                  ToggleWidget(),
                ],
              ),
            ),
          ),





      ]
      ),

    );
  }
}
